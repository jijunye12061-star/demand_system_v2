# config.py - 全局配置

# ============================================================
# 需求类型选项
# ============================================================
REQUEST_TYPES = [
    "调研",
    "基金筛选",
    "会议",
    "知识沉淀",
    "生产化|提效",
    "生产化|创新",
    "报告|定制",
    "报告|定期",
    "路演|线下",
    "路演|线上",
    "培训",
    "其他",
]

# ============================================================
# 研究范畴选项
# ============================================================
RESEARCH_SCOPES = [
    "纯债",
    "固收+",
    "权益",
    "量化",
    "其他",
]

# ============================================================
# 客户类型选项（用于"其他机构"时手动选择）
# ============================================================
ORG_TYPES = [
    "银行", "银行自营", "银行资管",
    "券商",
    "理财",
    "保险",
    "基金", "FOF",
    "信托",
    "其他"
]

# ============================================================
# 需求状态定义
# ============================================================
REQUEST_STATUS = {
    "pending": {"label": "待处理", "icon": "🟡"},
    "in_progress": {"label": "处理中", "icon": "🔵"},
    "completed": {"label": "已完成", "icon": "🟢"},
}

# ============================================================
# 角色定义
# ============================================================
ROLES = {
    "sales": {"label": "销售", "icon": "💼"},
    "researcher": {"label": "研究员", "icon": "🔬"},
    "admin": {"label": "管理员", "icon": "👑"},
}

# ============================================================
# 销售-机构映射关系
# key: 销售用户的 username (请与数据库中的 username 保持一致)
# value: 该销售可选的机构列表
# ============================================================
SALES_ORG_MAPPING = {
    "liyingsheng": ["交银理财", "融通财险", "上海银行"],
    "sunyumeng": ["中银理财", "英大资本", "泰康资产", "首创证券"],
    "liuqianyi": ["东方证券", "恒丰理财", "兴银理财"],
    "yaofang": ["中海信托"],
    "wuzehang": ["中信信托", "微盘股策略基金筛选", "客户不详233"],
    "duanying": ["海通资管", "国泰海通", "客户不详43"],
    "lidianzhe": ["中加fof"],
    "qiandingkun": ["中信信托"],
    "qianyibing": ["银河证券", "中信银行"],
    "guolijia": ["中信证券"],
    "niehuimin": ["五矿固收"],
    "huqiyang": ["泉州银行"],
    "jinchengjun": ["贵州银行"],
    "huhuihui": ["人保资产"],
}

# 是否允许销售选择"其他机构"
ALLOW_OTHER_ORG = True
DEFAULT_ORGS = ["其他机构"]

# ============================================================
# 机构-客户类型映射
# ============================================================
ORG_TYPE_MAPPING = {
    # 理财
    "交银理财": "理财",
    "中银理财": "理财",
    "恒丰理财": "理财",
    "兴银理财": "理财",

    # 保险
    "融通财险": "保险",
    "英大资本": "保险",
    "泰康资产": "保险",
    "人保资产": "保险",

    # 银行相关
    "上海银行": "银行自营",
    "泉州银行": "银行自营",
    "贵州银行": "银行资管",
    "中信银行": "银行资管",

    # 券商
    "东方证券": "券商",
    "海通资管": "券商",
    "国泰海通": "券商",
    "银河证券": "券商",
    "中信证券": "券商",
    "五矿固收": "券商",
    "首创证券": "券商",

    # 信托
    "中海信托": "信托",
    "中信信托": "信托",

    # FOF
    "中加fof": "FOF",
}

DEFAULT_ORG_TYPE = "其他"

# ============================================================
# 辅助函数
# ============================================================

def get_orgs_for_sales(username: str) -> list:
    """获取销售可选的机构列表"""
    orgs = SALES_ORG_MAPPING.get(username, DEFAULT_ORGS).copy()

    # 如果允许选择"其他机构"，且列表中没有，则添加
    if ALLOW_OTHER_ORG and "其他机构" not in orgs:
        orgs.append("其他机构")

    return orgs


def get_org_type(org_name: str) -> str:
    """根据机构名获取客户类型"""
    if not org_name:
        return DEFAULT_ORG_TYPE
    return ORG_TYPE_MAPPING.get(org_name, DEFAULT_ORG_TYPE)


def get_status_display(status: str) -> str:
    """获取状态的显示文本（带图标）"""
    info = REQUEST_STATUS.get(status, {"label": status, "icon": "⚪"})
    return f"{info['icon']} {info['label']}"


def get_role_display(role: str) -> str:
    """获取角色的显示文本"""
    info = ROLES.get(role, {"label": role})
    return info["label"]


def needs_remark(value: str) -> bool:
    """判断是否需要填写备注说明（选了"其他"时）"""
    return value == "其他"